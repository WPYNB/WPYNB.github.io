<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>sed简单应用 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一、sed应用处理文本的工具sedStream EDitor, 行编辑器sed是一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。然后读入下行，执行下一个循环。如果没有使诸如‘D’的特殊命令，那会在两个循环之间清空模式空间，但不会清空保留空间。这样不断重">
<meta property="og:type" content="article">
<meta property="og:title" content="sed简单应用">
<meta property="og:url" content="http://yoursite.com/2018/10/13/sed简单应用/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="一、sed应用处理文本的工具sedStream EDitor, 行编辑器sed是一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。然后读入下行，执行下一个循环。如果没有使诸如‘D’的特殊命令，那会在两个循环之间清空模式空间，但不会清空保留空间。这样不断重">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-10-13T08:15:51.951Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sed简单应用">
<meta name="twitter:description" content="一、sed应用处理文本的工具sedStream EDitor, 行编辑器sed是一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。然后读入下行，执行下一个循环。如果没有使诸如‘D’的特殊命令，那会在两个循环之间清空模式空间，但不会清空保留空间。这样不断重">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-sed简单应用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/13/sed简单应用/" class="article-date">
  <time datetime="2018-10-13T08:15:12.000Z" itemprop="datePublished">2018-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      sed简单应用
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一、sed应用"><a href="#一、sed应用" class="headerlink" title="一、sed应用"></a>一、sed应用</h1><h2 id="处理文本的工具sed"><a href="#处理文本的工具sed" class="headerlink" title="处理文本的工具sed"></a>处理文本的工具sed</h2><h3 id="Stream-EDitor-行编辑器"><a href="#Stream-EDitor-行编辑器" class="headerlink" title="Stream EDitor, 行编辑器"></a>Stream EDitor, 行编辑器</h3><h4 id="sed是一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern-space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。然后读入下行，执行下一个循环。如果没有使诸如‘D’的特殊命令，那会在两个循环之间清空模式空间，但不会清空保留空间。这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。"><a href="#sed是一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern-space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。然后读入下行，执行下一个循环。如果没有使诸如‘D’的特殊命令，那会在两个循环之间清空模式空间，但不会清空保留空间。这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。" class="headerlink" title="sed是一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。然后读入下行，执行下一个循环。如果没有使诸如‘D’的特殊命令，那会在两个循环之间清空模式空间，但不会清空保留空间。这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。"></a>sed是一种流编辑器，它一次处理一行内容。处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”（pattern space），接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。然后读入下行，执行下一个循环。如果没有使诸如‘D’的特殊命令，那会在两个循环之间清空模式空间，但不会清空保留空间。这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。</h4><h2 id="功能：主要用来自动编辑一个或多个文件-简化对文件的反复操作-编写转换程序等"><a href="#功能：主要用来自动编辑一个或多个文件-简化对文件的反复操作-编写转换程序等" class="headerlink" title="功能：主要用来自动编辑一个或多个文件,简化对文件的反复操作,编写转换程序等"></a>功能：主要用来自动编辑一个或多个文件,简化对文件的反复操作,编写转换程序等</h2><h2 id="sed工具"><a href="#sed工具" class="headerlink" title="sed工具"></a>sed工具</h2><h3 id="用法："><a href="#用法：" class="headerlink" title="用法："></a>用法：</h3><p>sed [option]… ‘script’ inputfile…</p>
<h3 id="常用选项："><a href="#常用选项：" class="headerlink" title="常用选项："></a>常用选项：</h3><p>-n 不输出模式空间内容到屏幕，即不自动打印</p>
<p>-e 多点编辑</p>
<p>-f /PATH/SCRIPT_FILE 从指定文件中读取编辑脚本</p>
<p>-r 支持使用扩展正则表达式</p>
<p>-i.bak 备份文件并原处编辑</p>
<p>script:<br>‘地址命令</p>
<h3 id="地址定界："><a href="#地址定界：" class="headerlink" title="地址定界："></a>地址定界：</h3><p>(1) 不给地址：对全文进行处理</p>
<p>(2) 单地址：<br>“#: 指定的行，$：最后一行</p>
<p>/pattern/：被此处模式所能够匹配到的每一行</p>
<p>(3) 地址范围：</p>
<p>“#,#”</p>
<p>“#,+#“</p>
<p>/pat1/,/pat2/</p>
<p>“#,/pat1/”</p>
<p>(4) ~：步进</p>
<p>1~2 奇数行</p>
<p>2~2 偶数行</p>
<h3 id="编辑命令："><a href="#编辑命令：" class="headerlink" title="编辑命令："></a>编辑命令：</h3><p>d 删除模式空间匹配的行，并立即启用下一轮循环</p>
<p>p 打印当前模式空间内容，追加到默认输出之后</p>
<p>a []text 在指定行后面追加文本，支持使用\n实现多行追加</p>
<p>i []text 在行前面插入文本</p>
<p>c []text 替换行为单行或多行文本</p>
<p>w /path/file 保存模式匹配的行至指定文件</p>
<p>r /path/file 读取指定文件的文本至模式空间中匹配到的行后</p>
<p>= 为模式空间中的行打印行号</p>
<p>! 模式空间中匹配行取反处理</p>
<p>s/// 查找替换,支持使用其它分隔符，s@@@，s###</p>
<h3 id="替换标记："><a href="#替换标记：" class="headerlink" title="替换标记："></a>替换标记：</h3><p>g 行内全局替换</p>
<p>p 显示替换成功的行</p>
<p>w /PATH/FILE 将替换成功的行保存至文件中</p>
<h1 id="二、实验"><a href="#二、实验" class="headerlink" title="二、实验"></a>二、实验</h1><h2 id="1、删除centos7系统-etc-grub2-cfg文件中所有以空白开头的行行首的空白字符"><a href="#1、删除centos7系统-etc-grub2-cfg文件中所有以空白开头的行行首的空白字符" class="headerlink" title="1、删除centos7系统/etc/grub2.cfg文件中所有以空白开头的行行首的空白字符"></a>1、删除centos7系统/etc/grub2.cfg文件中所有以空白开头的行行首的空白字符</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -nr &quot;s/^[[:space:]]//p&quot; /etc/grub2.cfg </span><br><span class="line">-r  支持扩展正则表达式</span><br><span class="line">s///  替换</span><br></pre></td></tr></table></figure>
<h2 id="2、删除-etc-fstab文件中所有以-开头，后面至少跟一个空白字符的行的行首的-和空白字符"><a href="#2、删除-etc-fstab文件中所有以-开头，后面至少跟一个空白字符的行的行首的-和空白字符" class="headerlink" title="2、删除/etc/fstab文件中所有以#开头，后面至少跟一个空白字符的行的行首的#和空白字符"></a>2、删除/etc/fstab文件中所有以#开头，后面至少跟一个空白字符的行的行首的#和空白字符</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -r &apos;/^#[[:space:]]+/d&apos; /etc/fstab</span><br></pre></td></tr></table></figure>
<h2 id="3、在centos6系统-root-install-log每一行行首增加-号"><a href="#3、在centos6系统-root-install-log每一行行首增加-号" class="headerlink" title="3、在centos6系统/root/install.log每一行行首增加#号"></a>3、在centos6系统/root/install.log每一行行首增加#号</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &apos;s/^/#/&apos; /root/install.log</span><br></pre></td></tr></table></figure>
<h2 id="4、在-etc-fstab文件中不以-开头的行的行首增加-号"><a href="#4、在-etc-fstab文件中不以-开头的行的行首增加-号" class="headerlink" title="4、在/etc/fstab文件中不以#开头的行的行首增加#号"></a>4、在/etc/fstab文件中不以#开头的行的行首增加#号</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed &apos;s@^[^#]@#&amp;@&apos; /etc/fstab</span><br><span class="line">s//&amp;/  后项引用</span><br></pre></td></tr></table></figure>
<h2 id="5、处理-etc-fstab路径-使用sed命令取出其目录名和基名"><a href="#5、处理-etc-fstab路径-使用sed命令取出其目录名和基名" class="headerlink" title="5、处理/etc/fstab路径,使用sed命令取出其目录名和基名"></a>5、处理/etc/fstab路径,使用sed命令取出其目录名和基名</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;/etc/sysconfig/network-scripts/&quot;|sed -r &apos;s@(^/.*/)([^/]+/?)@\2@&apos;取基名 echo &quot;/etc/sysconfig/network-scripts/&quot;|sed -r &apos;s@(^/.*/)([^/]+/?)@\1@&apos;取目录名 </span><br><span class="line">s/()()/\1/ 后项引用 </span><br><span class="line">s/()()/\2/</span><br></pre></td></tr></table></figure>
<h2 id="6、利用sed-取出ifconfig命令中本机的IPv4地址-不同版本名称不同，写路径时注意。演示版本为centos6"><a href="#6、利用sed-取出ifconfig命令中本机的IPv4地址-不同版本名称不同，写路径时注意。演示版本为centos6" class="headerlink" title="6、利用sed 取出ifconfig命令中本机的IPv4地址(不同版本名称不同，写路径时注意。演示版本为centos6)"></a>6、利用sed 取出ifconfig命令中本机的IPv4地址(不同版本名称不同，写路径时注意。演示版本为centos6)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ifconfig|sed -n &apos;2p&apos;|sed &apos;s/^.*r://&apos; |sed &apos;s/ .*//&apos; </span><br><span class="line">ifconfig|sed -n &apos;2p&apos;|sed &apos;s/^[[:space:]].*r://&apos;|sed &apos;s/[[:space:]].*//&apos; </span><br><span class="line">ifconfig|sed -n &apos;2p&apos;|sed -e &apos;s/^[[:space:]].*r://&apos; -e &apos;s/[[:space:]].*//&apos; </span><br><span class="line">ifconfig|sed -n -e &apos;2s/^[[:space:]].*r://&apos; -e &apos;2s/[[:space:]].*//p&apos;</span><br></pre></td></tr></table></figure>
<h2 id="7、统计centos安装光盘中Package目录下的所有rpm文件的以-分隔倒数第二个字段的重复次数-不同版本路径不同，写路径时注意。演示版本为centos6"><a href="#7、统计centos安装光盘中Package目录下的所有rpm文件的以-分隔倒数第二个字段的重复次数-不同版本路径不同，写路径时注意。演示版本为centos6" class="headerlink" title="7、统计centos安装光盘中Package目录下的所有rpm文件的以.分隔倒数第二个字段的重复次数(不同版本路径不同，写路径时注意。演示版本为centos6)"></a>7、统计centos安装光盘中Package目录下的所有rpm文件的以.分隔倒数第二个字段的重复次数(不同版本路径不同，写路径时注意。演示版本为centos6)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls /misc/cd/Packages/|grep &quot;rpm$&quot;|sed -r &apos;s@.*\.(.*)\.rpm@\1@&apos;|sort|uniq -c </span><br><span class="line">ls /misc/cd/Packages/|grep &quot;rpm$&quot;|sed -e &apos;s@.rpm$@@&apos; -e &apos;s@.*\.@@&apos;|sort|uniq -c </span><br><span class="line">ls /misc/cd/Packages/|rev|cut -d. -f2|sort -nr|rev|uniq -c|sort -nr|head -n3</span><br></pre></td></tr></table></figure>
<h2 id="8、统计-etc-init-d-functions文件中每个单词的出现次数，并排序（用grep和sed两种方法分别实现）"><a href="#8、统计-etc-init-d-functions文件中每个单词的出现次数，并排序（用grep和sed两种方法分别实现）" class="headerlink" title="8、统计/etc/init.d/functions文件中每个单词的出现次数，并排序（用grep和sed两种方法分别实现）"></a>8、统计/etc/init.d/functions文件中每个单词的出现次数，并排序（用grep和sed两种方法分别实现）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/init.d/functions|tr -c &apos;[:alpha:]&apos; &apos;\n&apos;|tr -s &apos;\n&apos;|sort|uniq -c|sort -nr</span><br><span class="line"></span><br><span class="line">grep -Eo &quot;\&lt;[[:alpha:]_]+[[:alnum:]]+\&gt;&quot; /etc/init.d/functions|sort|uniq -c|sort -n </span><br><span class="line"></span><br><span class="line">sed -nre &apos;s/[^[:alnum:]]+/\n/g&apos; -e &apos;s/[0-9]/\n/gp&apos; /etc/init.d/functions|sort|uniq -c|sort -n</span><br></pre></td></tr></table></figure>
<h2 id="9、将文本文件的n和n-1行合并为一行，n为奇数行"><a href="#9、将文本文件的n和n-1行合并为一行，n为奇数行" class="headerlink" title="9、将文本文件的n和n+1行合并为一行，n为奇数行"></a>9、将文本文件的n和n+1行合并为一行，n为奇数行</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd|sed -n &apos;N;s/\n//p&apos;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/13/sed简单应用/" data-id="cjn7633gq00033kbfp5wnxvwk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/10/13/Linux软硬连接/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Linux软硬连接</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/10/13/sed简单应用/">sed简单应用</a>
          </li>
        
          <li>
            <a href="/2018/10/13/Linux软硬连接/">Linux软硬连接</a>
          </li>
        
          <li>
            <a href="/2018/10/13/更改开机自动登录/">更改开机自动登录</a>
          </li>
        
          <li>
            <a href="/2018/10/13/screen/">screen会话建立</a>
          </li>
        
          <li>
            <a href="/2018/10/13/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>